<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>Retraining Report</title>



  <link href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">





    <!-- Font Awesome -->
<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css">
<!-- Bootstrap core CSS -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
<!-- Material Design Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/css/mdb.min.css" rel="stylesheet">



<!-- JQuery -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
<!-- Bootstrap tooltips -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.4/umd/popper.min.js"></script>
<!-- Bootstrap core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>
<!-- MDB core JavaScript -->
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.8.10/js/mdb.min.js"></script>


<link href="./success.css" rel="stylesheet">



<style>

body {
    font-size: 1em;
    background: #fafafa;
    font-family: Lato;
    font-weight: 300;
}
        

.spinner input {
  text-align: right;
}
.input-group-btn-vertical {
  position: relative;
  white-space: nowrap;
  width: 1%;
  vertical-align: middle;
  display: table-cell;
}
.input-group-btn-vertical > .btn {
  display: block;
  float: none;
  width: 100%;
  max-width: 100%;
  padding: 8px;
  margin-left: -1px;
  position: relative;
  border-radius: 0;
}
.input-group-btn-vertical > .btn:first-child {
  border-top-right-radius: 4px;
}
.input-group-btn-vertical > .btn:last-child {
  margin-top: -2px;
  border-bottom-right-radius: 4px;
}
.input-group-btn-vertical i{
  position: absolute;
  top: 0;
  left: 4px;
}


.modal-confirm {		
	font-family: 'Varela Round', sans-serif;
	color: #636363;
	width: 325px;
}
.modal-confirm .modal-content {
	padding: 20px;
	border-radius: 5px;
	border: none;
}
.modal-confirm .modal-header {
	border-bottom: none;   
	position: relative;
}
.modal-confirm h4 {
	text-align: center;
	font-size: 26px;
	margin: 30px 0 -15px;
}
.modal-confirm .form-control, .modal-confirm .btn {
	min-height: 40px;
	border-radius: 3px; 
}
.modal-confirm .close {
	position: absolute;
	top: -5px;
	right: -5px;
}	
.modal-confirm .modal-footer {
	border: none;
	text-align: center;
	border-radius: 5px;
	font-size: 13px;
}	
.modal-confirm .icon-box {
	color: #fff;		
	position: absolute;
	margin: 0 auto;
	left: 0;
	right: 0;
	top: -70px;
	width: 95px;
	height: 95px;
	border-radius: 50%;
	z-index: 9;
	background: #82ce34;
	padding: 15px;
	text-align: center;
	box-shadow: 0px 2px 2px rgba(0, 0, 0, 0.1);
}
.modal-confirm .icon-box i {
	font-size: 58px;
	position: relative;
	top: 3px;
}
.modal-confirm.modal-dialog {
	margin-top: 80px;
}
.modal-confirm .btn {
	color: #fff;
	border-radius: 4px;
	background: #82ce34;
	text-decoration: none;
	transition: all 0.4s;
	line-height: normal;
	border: none;
}
.modal-confirm .btn:hover, .modal-confirm .btn:focus {
	background: #6fb32b;
	outline: none;
}
.trigger-btn {
	display: none;
	margin: 100px auto;
}

.loader {
  border: 16px solid #f3f3f3; /* Light grey */
  border-top: 16px solid #3498db; /* Blue */
  border-radius: 50%;
  width: 120px;
  height: 120px;
  animation: spin 2s linear infinite;
}

@keyframes spin {
  0% { transform: rotate(0deg); }
  100% { transform: rotate(360deg); }
}


</style>
        

</head>
<body>
    <div id="alert_placeholder"></div>
  </div>
<!-- Extended default form grid -->
<form id="mainForm" style="margin-left:2%;margin-right:40%;margin-top: 2%">
        <!-- Grid row -->
        <div class="form-group">
          <!-- Default input -->
          
            <label for="packageName">Package Name</label>
            <input type="text" class="form-control" id="packageName" placeholder="My Package" required>
          </div>
          <!-- Default input -->

          
              <!-- Default input -->
              
              <!-- Default input -->
              <div class="form-group">
                <label class="radio-inline"><input type="radio" name="optradio" id="updateRadio" checked>Update</label>
                <label class="radio-inline" style="margin-left:2%"><input type="radio" name="optradio" id="deleteRadio">Delete</label>
                </div>
          
          <div class="form-group">
                <div class="form-check">
                    <input class="form-check-input" type="checkbox" id="gridCheck">
                    <label class="form-check-label" for="gridCheck">
                    Retrain once updated
                    </label>
                </div>
          </div>
       
        <!-- Grid row -->
        <div class="form-group"></div>
        <button type="submit" class="btn btn-primary btn-md" id="submitButt" style="float: right">Submit</button>
        <div class="form-group"></div>
      </form>
      <div id="myModal" class="modal fade">
        <div class="modal-dialog modal-confirm">
          <div class="modal-content">
            <div class="modal-header">
              <div class="icon-box">
                <i class="material-icons">&#xE876;</i>
              </div>				
              <h4 class="modal-title" style="width: 100%">Awesome!</h4>	
            </div>
            <div class="modal-body">
              <p class="text-center">Your package has been registered successfully. You should receive a confirmation email shortly.</p>
            </div>
            <div class="modal-footer">
              <button class="btn btn-block" data-dismiss="modal" onclick="goHome();">Home</button>
            </div>
          </div>
        </div>
      </div>   
  
      <a id="hiddenSuccessTrigger" href="#myModal" class="trigger-btn" data-toggle="modal"></a>
      <!-- Extended default form grid -->
  <!-- Extended material form grid -->
</body>
<script>


// this is the id of the form
$("#mainForm").submit(function(e) {
  
  e.preventDefault();

  var xhr = new XMLHttpRequest();

  isDeleteRequest=$('gridCheck').attr("disabled")
  urlCommand=""

  if (isDeleteRequest){
    urlCommand="delete"
    data={"packageName":$("#packageName").val()}
  }else //it's an update
  {
    data={"packageName":$("#packageName").val(),"reTrainAfterUpdate":$('#gridCheck').prop('checked')}
    urlCommand="update"
  }


  var url = "http://127.0.0.1:5000/"+urlCommand;

  xhr.onreadystatechange = function () {
      if (xhr.readyState === 4 ){
        $("#submitButt").html('Submit')
        $("#submitButt").attr("disabled",false)
      if (xhr.status === 200) {
        $('#hiddenSuccessTrigger').click();
      }else{
        commStr=isDeleteRequest?"Delete":"Update";
        bootstrap_alert( ' Failed! '+xhr.responseText);
        console.log("laaaaaaaaaaa2aaaaaaaaa")
      }
    }
    
  };
  

xhr.open("POST", url);
xhr.setRequestHeader("Content-Type", "application/json;charset=UTF-8");
data=JSON.stringify(data);
console.log(data)
xhr.send(data);


$("#submitButt").html('<span class="spinner-border spinner-border-sm" role="status" aria-hidden="true"></span> Submit')
$("#submitButt").attr("disabled",true)



});

$("#deleteRadio").change(function () {
    $("#gridCheck").attr("disabled", true);
  });    
  
$("#updateRadio").change(function () {
    $("#gridCheck").removeAttr("disabled");
});

function bootstrap_alert(message, timeout) {
  
  
  $('#alert_placeholder').append('<div id="alertdiv" class="alert alert-danger"><a class="close" data-dismiss="alert">Ã—</a><span>'+message+'</span></div>')
};
</script>
</html>